<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Serial Wombat 18AB Firmware: HSCounter.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="red&whitetorso.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Serial Wombat 18AB Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_76585f90922fbf82f2aa1a9aef79586a.html">SerialWombat18A_18B.X</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">HSCounter.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="serial_wombat_8h_source.html">serialWombat.h</a>&quot;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="input_process_8h_source.html">inputProcess.h</a>&quot;</code><br />
<code>#include &quot;pic24fj256ga702/mcc_generated_files/mcc.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_h_s_counter__n.html">HSCounter_n</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad3084a4f4e89e3e41ac345e0d9a2f4be"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_h_s_counter__n.html">HSCounter_n</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_s_counter_8c.html#ad3084a4f4e89e3e41ac345e0d9a2f4be">HSCounter_t</a></td></tr>
<tr class="separator:ad3084a4f4e89e3e41ac345e0d9a2f4be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a728ad0eb973a583e39d4a514c01e204d"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_s_counter_8c.html#a728ad0eb973a583e39d4a514c01e204d">HSCOUNTER_PUBLIC_DATA</a> { <a class="el" href="_h_s_counter_8c.html#a728ad0eb973a583e39d4a514c01e204dae8ed35d9298f433e30ed0a87b152893e">PULSE_COUNT</a> = 2, 
<a class="el" href="_h_s_counter_8c.html#a728ad0eb973a583e39d4a514c01e204dae74b8dfbf4cd8300fa758336fc022aec">FREQUENCY_ON_LTH_TRANSITION</a> = 5
 }</td></tr>
<tr class="memdesc:a728ad0eb973a583e39d4a514c01e204d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This enum is designed to be compatible with PULSE_TIMER_PUBLIC_DATA.  <a href="_h_s_counter_8c.html#a728ad0eb973a583e39d4a514c01e204d">More...</a><br /></td></tr>
<tr class="separator:a728ad0eb973a583e39d4a514c01e204d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acfa1439305ba2f77dcfbdf5dd7763645"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_s_counter_8c.html#acfa1439305ba2f77dcfbdf5dd7763645">initHSCounter</a> (void)</td></tr>
<tr class="separator:acfa1439305ba2f77dcfbdf5dd7763645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a545e50589e9a6d582cad86efc213f0cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_s_counter_8c.html#a545e50589e9a6d582cad86efc213f0cb">updateHSCounter</a> ()</td></tr>
<tr class="memdesc:a545e50589e9a6d582cad86efc213f0cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function that updates High Speed Counter mode.  <a href="_h_s_counter_8c.html#a545e50589e9a6d582cad86efc213f0cb">More...</a><br /></td></tr>
<tr class="separator:a545e50589e9a6d582cad86efc213f0cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aae010fdc86907e65ecac76597696c35c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_h_s_counter_8c.html#ad3084a4f4e89e3e41ac345e0d9a2f4be">HSCounter_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_s_counter_8c.html#aae010fdc86907e65ecac76597696c35c">debugHSCounter</a></td></tr>
<tr class="separator:aae010fdc86907e65ecac76597696c35c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ad3084a4f4e89e3e41ac345e0d9a2f4be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3084a4f4e89e3e41ac345e0d9a2f4be">&#9670;&nbsp;</a></span>HSCounter_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_h_s_counter__n.html">HSCounter_n</a> <a class="el" href="_h_s_counter_8c.html#ad3084a4f4e89e3e41ac345e0d9a2f4be">HSCounter_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a728ad0eb973a583e39d4a514c01e204d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a728ad0eb973a583e39d4a514c01e204d">&#9670;&nbsp;</a></span>HSCOUNTER_PUBLIC_DATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_h_s_counter_8c.html#a728ad0eb973a583e39d4a514c01e204d">HSCOUNTER_PUBLIC_DATA</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This enum is designed to be compatible with PULSE_TIMER_PUBLIC_DATA. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a728ad0eb973a583e39d4a514c01e204dae8ed35d9298f433e30ed0a87b152893e"></a>PULSE_COUNT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a728ad0eb973a583e39d4a514c01e204dae74b8dfbf4cd8300fa758336fc022aec"></a>FREQUENCY_ON_LTH_TRANSITION&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="acfa1439305ba2f77dcfbdf5dd7763645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfa1439305ba2f77dcfbdf5dd7763645">&#9670;&nbsp;</a></span>initHSCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initHSCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a545e50589e9a6d582cad86efc213f0cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a545e50589e9a6d582cad86efc213f0cb">&#9670;&nbsp;</a></span>updateHSCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateHSCounter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function that updates High Speed Counter mode. </p>
<p>On the Serial Wombat 18AB chip the counting is done by the timer hardware on MCCP1 or CCP2 The update looks to see if the specified number of frames has passed and if so updates the frequency and count. <br  />
 </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aae010fdc86907e65ecac76597696c35c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae010fdc86907e65ecac76597696c35c">&#9670;&nbsp;</a></span>debugHSCounter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_h_s_counter_8c.html#ad3084a4f4e89e3e41ac345e0d9a2f4be">HSCounter_t</a>* debugHSCounter</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">\brief Initialization routine for High Speed Counter
</pre><hr  />
<p>TODO</p>
<h2><a class="anchor" id="autotoc_md18"></a>
CONFIGURE_CHANNEL_MODE_0:</h2>
<p>Initialize High Speed Counter</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">BYTE 0 </th><th class="markdownTableHeadLeft">BYTE 1 </th><th class="markdownTableHeadLeft">BYTE 2 </th><th class="markdownTableHeadLeft">BYTE 3 </th><th class="markdownTableHeadLeft">BYTE 4 </th><th class="markdownTableHeadLeft">BYTE 5 </th><th class="markdownTableHeadLeft">BYTE 6 </th><th class="markdownTableHeadLeft">BYTE 7  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">0xC0 </td><td class="markdownTableBodyLeft">Pin To Set (TO HS Counter) </td><td class="markdownTableBodyLeft">0x1# (HS Counter ) </td><td class="markdownTableBodyLeft">Sample Frames LSB </td><td class="markdownTableBodyLeft">Sample Frames MSB </td><td class="markdownTableBodyLeft">Public Data Divisor LSB </td><td class="markdownTableBodyLeft">Public Data Divisor LSB MSB </td><td class="markdownTableBodyLeft">Public data enum (2 = count, 5 = freq)  </td></tr>
</table>
<p>Sample Frames : The number of 1ms frames between frequency, public data updates. This should be a number that 1000 can be divided by with no remainder (e.g. 5, 25, 100, 250, etc) Public Data Divisor : A number to divide the public data output by before placing it in the 16 bit buffer. A value of 100 would allow a 2MHz frequency to be expressed at 20000 Public Data Enum: Set to 2 to output the number of counts as the pin public data, set to 5 to output frequency as the pin public data Response:</p>
<p>Command is echoed</p>
<p>Examples:</p>
<p>Set pin 19 to HS Counter, update every 100mS, output frequency divided by 10 as public data</p>
<blockquote class="doxtable">
<p><code>0xC0 0x13 0x1E 0x00 0x64 0xF8 0x03 0x05</code> </p>
</blockquote>
<hr  />
<h2><a class="anchor" id="autotoc_md20"></a>
CONFIGURE_CHANNEL_MODE_19:</h2>
<p>Disable High Speed Counter and return the hardware resource used to the timing resource allocator</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">BYTE 0 </th><th class="markdownTableHeadLeft">BYTE 1 </th><th class="markdownTableHeadLeft">BYTE 2 </th><th class="markdownTableHeadLeft">BYTE 3 </th><th class="markdownTableHeadLeft">BYTE 4 </th><th class="markdownTableHeadLeft">BYTE 5 </th><th class="markdownTableHeadLeft">BYTE 6 </th><th class="markdownTableHeadLeft">BYTE 7  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">0xC0 </td><td class="markdownTableBodyLeft">Pin To Set (TO HS Clock) </td><td class="markdownTableBodyLeft">0x1D (HS Clock ) </td><td class="markdownTableBodyLeft">0x55 </td><td class="markdownTableBodyLeft">0x55 </td><td class="markdownTableBodyLeft">0x55 </td><td class="markdownTableBodyLeft">0x55 </td><td class="markdownTableBodyLeft">0x55  </td></tr>
</table>
<p>Response:</p>
<p>Echoed back</p>
<p>Examples:</p>
<p>Disable pin 19 HS Clock</p>
<blockquote class="doxtable">
<p><code>0xDB 0x13 0x1D 0x55 0x55 0x55 0x55 0x55</code> </p>
</blockquote>
<hr  />
 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
